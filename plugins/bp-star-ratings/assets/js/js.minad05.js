/**
 * Plugin: BP Star Ratings
 *
 * Description: js for the wordpress plugin BP Star Ratings.
 *
 * @package BP Star Ratings
 * @subpackage WordPress Plugin
 * @author WPEra
 * @plugin_uri http://wakeusup.com/2011/05/bp-star-ratings/
 */
!function(e,t,n,s){e.fn.bpstarratings=function(t){e.fn.bpstarratings.options=e.extend({ajaxurl:null,nonce:null,func:null,grs:!1,msg:"Rate this post",fuelspeed:400,thankyou:"Thank you for rating.",error_msg:"An error occured.",tooltip:!0,tooltips:{0:{tip:"Poor",color:"red"},1:{tip:"Fair",color:"brown"},2:{tip:"Average",color:"orange"},3:{tip:"Good",color:"blue"},4:{tip:"Excellent",color:"green"}}},e.fn.bpstarratings.options,t||{});var n=[];return this.each(function(){n.push(e(this))}),e.fn.bpstarratings.fetch(n,0,"0%",e.fn.bpstarratings.options.msg,!0),this.each(function(){})},e.fn.bpstarratings.animate=function(i){if(i.hasClass("disabled"))e(".bpsr-stars a",i).unbind("click").click(function(){return!1});else{var t={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return t.Android()||t.BlackBerry()||t.iOS()||t.Opera()||t.Windows()}};if(t.any())e(".bpsr-stars a",i).unbind("click").click(function(){return e.fn.bpstarratings.click(i,e(this).attr("href").split("#")[1])});else{var n=e(".bpsr-legend",i).html(),s=e(".bpsr-fuel",i).css("width");e(".bpsr-stars a",i).hover(function(){var a=e(this).attr("href").split("#")[1];0!=e.fn.bpstarratings.options.tooltip&&(null!=e.fn.bpstarratings.options.tooltips[a-1]?e(".bpsr-legend",i).html('<span style="color:'+e.fn.bpstarratings.options.tooltips[a-1].color+'">'+e.fn.bpstarratings.options.tooltips[a-1].tip+"</span>"):e(".bpsr-legend",i).html(n)),e(".bpsr-fuel",i).stop(!0,!0).css("width","0%"),e(".bpsr-stars a",i).each(function(t,n){var s=e(this),r=s.attr("href").split("#")[1];parseInt(r)<=parseInt(a)&&(e(".bpsr-stars a",i).stop(!0,!0),s.hide().addClass("bpsr-star").addClass("orange").fadeIn("fast"))})},function(){e(".bpsr-stars a",i).removeClass("bpsr-star").removeClass("orange"),0!=e.fn.bpstarratings.options.tooltip&&e(".bpsr-legend",i).html(n),e(".bpsr-fuel",i).stop(!0,!0).animate({width:s},e.fn.bpstarratings.options.fuelspeed)}).unbind("click").click(function(){return e.fn.bpstarratings.click(i,e(this).attr("href").split("#")[1])})}}},e.fn.bpstarratings.update=function(t,n,s,r,a){"true"==r&&e(".bpsr-fuel",t).removeClass("yellow").addClass("orange"),e(".bpsr-fuel",t).stop(!0,!0).animate({width:n},e.fn.bpstarratings.options.fuelspeed,"linear",function(){"true"==r&&(t.addClass("disabled"),e(".bpsr-stars a",t).unbind("hover")),e.fn.bpstarratings.options.grs&&a?e.fn.bpstarratings.animate(t):e(".bpsr-legend",t).stop(!0,!0).hide().html(s||e.fn.bpstarratings.options.msg).fadeIn("slow",function(){e.fn.bpstarratings.animate(t)})})},e.fn.bpstarratings.click=function(t,n){e(".bpsr-stars a",t).unbind("hover").unbind("click").removeClass("bpsr-star").removeClass("orange").click(function(){return!1});var s=e(".bpsr-legend",t).html(),r=e(".bpsr-fuel",t).css("width");return e.fn.bpstarratings.fetch(t,n,r,s,!1),!1},e.fn.bpstarratings.fetch=function(n,t,r,a,i){var s=[];e.each(n,function(){s.push(e(this).attr("data-id"))}),e.ajax({url:e.fn.bpstarratings.options.ajaxurl,data:"action="+e.fn.bpstarratings.options.func+"&id="+s+"&stars="+t+"&_wpnonce="+e.fn.bpstarratings.options.nonce,type:"post",dataType:"json",beforeSend:function(){e(".bpsr-fuel",n).animate({width:"0%"},e.fn.bpstarratings.options.fuelspeed),t&&e(".bpsr-legend",n).fadeOut("fast",function(){e(".bpsr-legend",n).html('<span style="color: green">'+e.fn.bpstarratings.options.thankyou+"</span>")}).fadeIn("slow")},success:function(s){e.each(n,function(){var t=e(this),n=t.attr("data-id");s[n].success?e.fn.bpstarratings.update(t,s[n].fuel+"%",s[n].legend,s[n].disable,i):e.fn.bpstarratings.update(t,r,a,!1,i)})},complete:function(){},error:function(t){e(".bpsr-legend",n).fadeOut("fast",function(){e(".bpsr-legend",n).html('<span style="color: red">'+e.fn.bpstarratings.options.error_msg+"</span>")}).fadeIn("slow",function(){e.fn.bpstarratings.update(n,r,a,!1,i)})}})},e.fn.bpstarratings.options={ajaxurl:bepassive_plugin_bpsr_js.ajaxurl,func:bepassive_plugin_bpsr_js.func,nonce:bepassive_plugin_bpsr_js.nonce,grs:bepassive_plugin_bpsr_js.grs,tooltip:bepassive_plugin_bpsr_js.tooltip,tooltips:bepassive_plugin_bpsr_js.tooltips,msg:bepassive_plugin_bpsr_js.msg,fuelspeed:bepassive_plugin_bpsr_js.fuelspeed,thankyou:bepassive_plugin_bpsr_js.thankyou,error_msg:bepassive_plugin_bpsr_js.error_msg}}(jQuery,window,document),jQuery(document).ready(function(t){t(".bp-star-ratings").bpstarratings()});